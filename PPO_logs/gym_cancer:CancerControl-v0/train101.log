nohup: ignoring input
============================================================================================
Remove CancerControl-v0 from registry
============================================================================================
Device set to : NVIDIA GeForce RTX 3090
============================================================================================
training environment name : gym_cancer:CancerControl-v0--patient101
2021-12-06 11:25:26.419255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
current logging run number for gym_cancer:CancerControl-v0 :  0
Actions are logged at : PPO_logs/gym_cancer:CancerControl-v0//patient101/PPO_ActionList_gym_cancer:CancerControl-v0_patient101_log_0.csv
save checkpoint path : PPO_preTrained/gym_cancer:CancerControl-v0/patient101/
save checkpoint format : patient101_20211206-1125_PPO_gym_cancer:CancerControl-v0_0_0.pth
--------------------------------------------------------------------------------------------
num of envs : 2
max training updating times :  100000
max timesteps per episode :  120
model saving frequency : 500 episodes
log frequency : 2 episodes
printing average reward over episodes in last : 2 episodes
--------------------------------------------------------------------------------------------
state space dimension :  7
action space dimension :  10
--------------------------------------------------------------------------------------------
Initializing a discrete action space policy
--------------------------------------------------------------------------------------------
The initial explore rate : 0.8 and initial exploit rate is : 1- 0.8
PPO update frequency : 2 episodes
PPO K epochs :  4
PPO epsilon clip :  0.2
discount factor (gamma) :  0.99
--------------------------------------------------------------------------------------------
decaying optimizer with step size :  500  decay ratio :  0.5
optimizer learning rate actor :  3e-05
optimizer learning rate critic :  0.0001
============================================================================================
Started training at (GMT) :  2021-12-06 11:25:32
============================================================================================
Updates : 0 		 SurvivalMonths : 39.0 		 Average Reward : -979.48
--------------------------------------------------------------------------------------------
saving model at : PPO_preTrained/gym_cancer:CancerControl-v0/patient101/final/patient101_20211206-1125_PPO_gym_cancer:CancerControl-v0_0_0.pth
model saved
Elapsed Time  :  0:00:04
--------------------------------------------------------------------------------------------
Updates : 2 		 SurvivalMonths : 46.0 		 Average Reward : -925.5
Updates : 4 		 SurvivalMonths : 45.5 		 Average Reward : -49.83
Updates : 6 		 SurvivalMonths : 45.5 		 Average Reward : -594.37
Updates : 8 		 SurvivalMonths : 39.5 		 Average Reward : -735.86
Updates : 10 		 SurvivalMonths : 41.5 		 Average Reward : 35.26
Updates : 12 		 SurvivalMonths : 39.5 		 Average Reward : -1030.18
Updates : 14 		 SurvivalMonths : 47.0 		 Average Reward : -676.25
Updates : 16 		 SurvivalMonths : 58.0 		 Average Reward : -2198.72
Updates : 18 		 SurvivalMonths : 39.5 		 Average Reward : -851.85
Updates : 20 		 SurvivalMonths : 62.5 		 Average Reward : -4646.08
Updates : 22 		 SurvivalMonths : 40.0 		 Average Reward : -368.68
Updates : 24 		 SurvivalMonths : 39.5 		 Average Reward : -868.57
Updates : 26 		 SurvivalMonths : 41.0 		 Average Reward : -981.31
Updates : 28 		 SurvivalMonths : 50.5 		 Average Reward : -1454.48
Updates : 30 		 SurvivalMonths : 39.5 		 Average Reward : -1065.73
Updates : 32 		 SurvivalMonths : 41.0 		 Average Reward : -942.73
Updates : 34 		 SurvivalMonths : 38.5 		 Average Reward : -579.97
Updates : 36 		 SurvivalMonths : 41.0 		 Average Reward : -745.2
Updates : 38 		 SurvivalMonths : 44.5 		 Average Reward : -1048.21
Updates : 40 		 SurvivalMonths : 56.5 		 Average Reward : -1284.73
Updates : 42 		 SurvivalMonths : 39.0 		 Average Reward : -193.64
Updates : 44 		 SurvivalMonths : 39.5 		 Average Reward : -459.37
Updates : 46 		 SurvivalMonths : 84.5 		 Average Reward : -1003843.6
Updates : 48 		 SurvivalMonths : 48.0 		 Average Reward : -512.84
Updates : 50 		 SurvivalMonths : 38.0 		 Average Reward : -681.61
Updates : 52 		 SurvivalMonths : 50.0 		 Average Reward : -514.33
Updates : 54 		 SurvivalMonths : 41.0 		 Average Reward : -167.65
Updates : 56 		 SurvivalMonths : 40.5 		 Average Reward : -974.11
Updates : 58 		 SurvivalMonths : 79.0 		 Average Reward : -6395633.02
Updates : 60 		 SurvivalMonths : 57.5 		 Average Reward : -34526.66
Updates : 62 		 SurvivalMonths : 40.5 		 Average Reward : 175.39
Updates : 64 		 SurvivalMonths : 40.0 		 Average Reward : -1276.73
Updates : 66 		 SurvivalMonths : 46.5 		 Average Reward : 22.22
Updates : 68 		 SurvivalMonths : 37.5 		 Average Reward : -433.74
Updates : 70 		 SurvivalMonths : 44.0 		 Average Reward : -618.63
Updates : 72 		 SurvivalMonths : 38.5 		 Average Reward : -282.92
Updates : 74 		 SurvivalMonths : 43.5 		 Average Reward : -239.53
Updates : 76 		 SurvivalMonths : 43.5 		 Average Reward : 80.9
Updates : 78 		 SurvivalMonths : 38.0 		 Average Reward : -448.74
Updates : 80 		 SurvivalMonths : 40.0 		 Average Reward : 76.29
Updates : 82 		 SurvivalMonths : 40.0 		 Average Reward : -232.01
Updates : 84 		 SurvivalMonths : 46.0 		 Average Reward : 384.03
Updates : 86 		 SurvivalMonths : 48.0 		 Average Reward : 739.73
Updates : 88 		 SurvivalMonths : 43.5 		 Average Reward : 287.04
Updates : 90 		 SurvivalMonths : 51.0 		 Average Reward : -1933.39
Updates : 92 		 SurvivalMonths : 40.5 		 Average Reward : -267.43
Updates : 94 		 SurvivalMonths : 39.5 		 Average Reward : 375.24
Updates : 96 		 SurvivalMonths : 80.0 		 Average Reward : -136162.7
Updates : 98 		 SurvivalMonths : 38.5 		 Average Reward : -27.75
Updates : 100 		 SurvivalMonths : 41.5 		 Average Reward : -245.65
Updates : 102 		 SurvivalMonths : 45.0 		 Average Reward : 885.12
Updates : 104 		 SurvivalMonths : 41.5 		 Average Reward : -256.19
Updates : 106 		 SurvivalMonths : 47.5 		 Average Reward : 522.63
Updates : 108 		 SurvivalMonths : 40.5 		 Average Reward : 179.21
Updates : 110 		 SurvivalMonths : 40.5 		 Average Reward : -149.23
Updates : 112 		 SurvivalMonths : 39.5 		 Average Reward : -97.13
Updates : 114 		 SurvivalMonths : 39.0 		 Average Reward : 262.84
Updates : 116 		 SurvivalMonths : 44.0 		 Average Reward : -8.93
Updates : 118 		 SurvivalMonths : 45.5 		 Average Reward : 643.13
Updates : 120 		 SurvivalMonths : 41.0 		 Average Reward : 192.15
Updates : 122 		 SurvivalMonths : 40.0 		 Average Reward : -270.87
Updates : 124 		 SurvivalMonths : 37.5 		 Average Reward : 13.62
Updates : 126 		 SurvivalMonths : 38.0 		 Average Reward : -37.28
Updates : 128 		 SurvivalMonths : 84.5 		 Average Reward : -25080.84
Updates : 130 		 SurvivalMonths : 40.0 		 Average Reward : -391.44
Updates : 132 		 SurvivalMonths : 42.0 		 Average Reward : -274.35
Updates : 134 		 SurvivalMonths : 82.0 		 Average Reward : 4122.41
Updates : 136 		 SurvivalMonths : 80.5 		 Average Reward : 3758.07
Updates : 138 		 SurvivalMonths : 40.0 		 Average Reward : -254.35
Updates : 140 		 SurvivalMonths : 45.0 		 Average Reward : 210.28
Updates : 142 		 SurvivalMonths : 42.0 		 Average Reward : 33.25
Updates : 144 		 SurvivalMonths : 80.5 		 Average Reward : 4174.01
Updates : 146 		 SurvivalMonths : 82.0 		 Average Reward : 3905.93
Updates : 148 		 SurvivalMonths : 42.0 		 Average Reward : -192.48
Updates : 150 		 SurvivalMonths : 77.5 		 Average Reward : 3536.63
Updates : 152 		 SurvivalMonths : 45.0 		 Average Reward : 318.14
Updates : 154 		 SurvivalMonths : 81.5 		 Average Reward : 4463.12
Updates : 156 		 SurvivalMonths : 52.5 		 Average Reward : -533.46
Updates : 158 		 SurvivalMonths : 42.0 		 Average Reward : -20.28
Updates : 160 		 SurvivalMonths : 83.0 		 Average Reward : 4344.05
Updates : 162 		 SurvivalMonths : 39.0 		 Average Reward : 12.62
Updates : 164 		 SurvivalMonths : 47.0 		 Average Reward : -399.31
Updates : 166 		 SurvivalMonths : 40.5 		 Average Reward : -163.14
Updates : 168 		 SurvivalMonths : 41.5 		 Average Reward : 91.63
Updates : 170 		 SurvivalMonths : 40.5 		 Average Reward : 470.31
Updates : 172 		 SurvivalMonths : 43.5 		 Average Reward : -15.16
Updates : 174 		 SurvivalMonths : 45.0 		 Average Reward : 212.27
Updates : 176 		 SurvivalMonths : 49.5 		 Average Reward : -489.09
Updates : 178 		 SurvivalMonths : 40.0 		 Average Reward : 182.71
Updates : 180 		 SurvivalMonths : 40.0 		 Average Reward : -213.23
Updates : 182 		 SurvivalMonths : 25.5 		 Average Reward : 553.52
Updates : 184 		 SurvivalMonths : 46.0 		 Average Reward : 313.71
Updates : 186 		 SurvivalMonths : 14.5 		 Average Reward : 1908.14
Updates : 188 		 SurvivalMonths : 42.5 		 Average Reward : -311.23
Updates : 190 		 SurvivalMonths : 28.5 		 Average Reward : 752.88
Updates : 192 		 SurvivalMonths : 42.5 		 Average Reward : -80.97
Updates : 194 		 SurvivalMonths : 14.0 		 Average Reward : 1789.66
Updates : 196 		 SurvivalMonths : 62.0 		 Average Reward : -1831.32
Updates : 198 		 SurvivalMonths : 27.0 		 Average Reward : 971.34
Updates : 200 		 SurvivalMonths : 40.5 		 Average Reward : 12.46
Updates : 202 		 SurvivalMonths : 46.0 		 Average Reward : -241.92
Updates : 204 		 SurvivalMonths : 44.5 		 Average Reward : -348.61
Updates : 206 		 SurvivalMonths : 39.5 		 Average Reward : -97.69
Updates : 208 		 SurvivalMonths : 39.0 		 Average Reward : 168.54
Updates : 210 		 SurvivalMonths : 46.0 		 Average Reward : -624.39
Updates : 212 		 SurvivalMonths : 41.0 		 Average Reward : -47.59
Updates : 214 		 SurvivalMonths : 54.0 		 Average Reward : 801.53
Updates : 216 		 SurvivalMonths : 28.5 		 Average Reward : 1035.8
Updates : 218 		 SurvivalMonths : 49.5 		 Average Reward : -313.25
Updates : 220 		 SurvivalMonths : 46.5 		 Average Reward : 33.81
Updates : 222 		 SurvivalMonths : 44.0 		 Average Reward : -107.25
Updates : 224 		 SurvivalMonths : 80.5 		 Average Reward : -74155.81
Updates : 226 		 SurvivalMonths : 27.5 		 Average Reward : 1147.58
Updates : 228 		 SurvivalMonths : 29.5 		 Average Reward : 957.3
Updates : 230 		 SurvivalMonths : 45.5 		 Average Reward : 261.51
Updates : 232 		 SurvivalMonths : 15.0 		 Average Reward : 2029.53
Updates : 234 		 SurvivalMonths : 48.0 		 Average Reward : -634.16
Updates : 236 		 SurvivalMonths : 60.5 		 Average Reward : -1246.51
Updates : 238 		 SurvivalMonths : 40.5 		 Average Reward : 175.58
Updates : 240 		 SurvivalMonths : 57.5 		 Average Reward : -14056.24
Updates : 242 		 SurvivalMonths : 42.5 		 Average Reward : -175.5
Updates : 244 		 SurvivalMonths : 47.5 		 Average Reward : 372.01
Updates : 246 		 SurvivalMonths : 28.5 		 Average Reward : 1130.41
Updates : 248 		 SurvivalMonths : 40.5 		 Average Reward : -112.93
Updates : 250 		 SurvivalMonths : 57.5 		 Average Reward : -119.67
Updates : 252 		 SurvivalMonths : 45.5 		 Average Reward : 69.51
Updates : 254 		 SurvivalMonths : 52.0 		 Average Reward : -10370.67
Updates : 256 		 SurvivalMonths : 41.5 		 Average Reward : 113.18
Updates : 258 		 SurvivalMonths : 28.5 		 Average Reward : 988.03
Updates : 260 		 SurvivalMonths : 39.5 		 Average Reward : 146.29
Updates : 262 		 SurvivalMonths : 54.5 		 Average Reward : -78.71
Updates : 264 		 SurvivalMonths : 42.5 		 Average Reward : 228.25
Updates : 266 		 SurvivalMonths : 39.0 		 Average Reward : -28.6
Updates : 268 		 SurvivalMonths : 42.5 		 Average Reward : 420.29
Updates : 270 		 SurvivalMonths : 35.5 		 Average Reward : 1238.52
Updates : 272 		 SurvivalMonths : 29.0 		 Average Reward : 846.81
Updates : 274 		 SurvivalMonths : 54.0 		 Average Reward : -38.92
Updates : 276 		 SurvivalMonths : 47.5 		 Average Reward : -807.81
Updates : 278 		 SurvivalMonths : 29.0 		 Average Reward : 1178.99
Updates : 280 		 SurvivalMonths : 48.0 		 Average Reward : 166.15
Updates : 282 		 SurvivalMonths : 46.5 		 Average Reward : 478.43
Updates : 284 		 SurvivalMonths : 58.5 		 Average Reward : 290.08
Updates : 286 		 SurvivalMonths : 59.0 		 Average Reward : 714.54
Updates : 288 		 SurvivalMonths : 51.5 		 Average Reward : 506.0
Updates : 290 		 SurvivalMonths : 43.0 		 Average Reward : 111.97
Updates : 292 		 SurvivalMonths : 48.0 		 Average Reward : 235.1
Updates : 294 		 SurvivalMonths : 51.5 		 Average Reward : 682.03
Updates : 296 		 SurvivalMonths : 49.0 		 Average Reward : 547.11
Updates : 298 		 SurvivalMonths : 54.5 		 Average Reward : 513.65
Updates : 300 		 SurvivalMonths : 27.5 		 Average Reward : 1122.58
Updates : 302 		 SurvivalMonths : 30.0 		 Average Reward : 1177.94
Updates : 304 		 SurvivalMonths : 31.0 		 Average Reward : 1229.73
Updates : 306 		 SurvivalMonths : 63.5 		 Average Reward : -620.64
Updates : 308 		 SurvivalMonths : 49.5 		 Average Reward : 415.13
Updates : 310 		 SurvivalMonths : 67.0 		 Average Reward : -3422.62
Updates : 312 		 SurvivalMonths : 82.0 		 Average Reward : -26680.83
Updates : 314 		 SurvivalMonths : 44.5 		 Average Reward : 66.06
Updates : 316 		 SurvivalMonths : 28.0 		 Average Reward : 990.33
Updates : 318 		 SurvivalMonths : 43.5 		 Average Reward : -11.18
Updates : 320 		 SurvivalMonths : 47.0 		 Average Reward : -6055.62
Updates : 322 		 SurvivalMonths : 90.5 		 Average Reward : -29054.83
Updates : 324 		 SurvivalMonths : 44.5 		 Average Reward : 471.72
Updates : 326 		 SurvivalMonths : 77.0 		 Average Reward : -6494.6
Updates : 328 		 SurvivalMonths : 15.0 		 Average Reward : 2029.53
Updates : 330 		 SurvivalMonths : 30.5 		 Average Reward : 987.49
Updates : 332 		 SurvivalMonths : 29.0 		 Average Reward : 1274.61
Updates : 334 		 SurvivalMonths : 57.0 		 Average Reward : 31.77
Updates : 336 		 SurvivalMonths : 86.0 		 Average Reward : -20563.56
Updates : 338 		 SurvivalMonths : 86.0 		 Average Reward : -102402.42
Updates : 340 		 SurvivalMonths : 49.0 		 Average Reward : 598.96
Updates : 342 		 SurvivalMonths : 99.5 		 Average Reward : -156270.77
Updates : 344 		 SurvivalMonths : 68.0 		 Average Reward : -43146.65
Updates : 346 		 SurvivalMonths : 70.0 		 Average Reward : -104.06
/home/yitao/PPO-Pytorch/env/gym_cancer/envs/cancercontrol.py:188: RuntimeWarning: invalid value encountered in log10
  normalized_states = np.log10(self.states) / np.log10(self.normalized_coef)
/opt/conda/conda-bld/pytorch_1607370172916/work/aten/src/ATen/native/cuda/MultinomialKernel.cu:190: sampleMultinomialOnce: block: [0,0,0], thread: [0,0,0] Assertion `val >= zero` failed.
/opt/conda/conda-bld/pytorch_1607370172916/work/aten/src/ATen/native/cuda/MultinomialKernel.cu:190: sampleMultinomialOnce: block: [0,0,0], thread: [1,0,0] Assertion `val >= zero` failed.
/opt/conda/conda-bld/pytorch_1607370172916/work/aten/src/ATen/native/cuda/MultinomialKernel.cu:190: sampleMultinomialOnce: block: [0,0,0], thread: [2,0,0] Assertion `val >= zero` failed.
/opt/conda/conda-bld/pytorch_1607370172916/work/aten/src/ATen/native/cuda/MultinomialKernel.cu:190: sampleMultinomialOnce: block: [0,0,0], thread: [3,0,0] Assertion `val >= zero` failed.
/opt/conda/conda-bld/pytorch_1607370172916/work/aten/src/ATen/native/cuda/MultinomialKernel.cu:190: sampleMultinomialOnce: block: [0,0,0], thread: [4,0,0] Assertion `val >= zero` failed.
/opt/conda/conda-bld/pytorch_1607370172916/work/aten/src/ATen/native/cuda/MultinomialKernel.cu:190: sampleMultinomialOnce: block: [0,0,0], thread: [5,0,0] Assertion `val >= zero` failed.
/opt/conda/conda-bld/pytorch_1607370172916/work/aten/src/ATen/native/cuda/MultinomialKernel.cu:190: sampleMultinomialOnce: block: [0,0,0], thread: [6,0,0] Assertion `val >= zero` failed.
/opt/conda/conda-bld/pytorch_1607370172916/work/aten/src/ATen/native/cuda/MultinomialKernel.cu:190: sampleMultinomialOnce: block: [0,0,0], thread: [7,0,0] Assertion `val >= zero` failed.
/opt/conda/conda-bld/pytorch_1607370172916/work/aten/src/ATen/native/cuda/MultinomialKernel.cu:190: sampleMultinomialOnce: block: [0,0,0], thread: [8,0,0] Assertion `val >= zero` failed.
/opt/conda/conda-bld/pytorch_1607370172916/work/aten/src/ATen/native/cuda/MultinomialKernel.cu:190: sampleMultinomialOnce: block: [0,0,0], thread: [9,0,0] Assertion `val >= zero` failed.
Traceback (most recent call last):
  File "train.py", line 534, in <module>
    train(args)
  File "train.py", line 371, in train
    state_tensor, action, action_logprob = ppo_agent.select_action(fea) \
  File "/home/yitao/PPO-Pytorch/PPO.py", line 213, in select_action
    return state, action.item(), action_logprob
RuntimeError: CUDA error: device-side assert triggered
