nohup: ignoring input
============================================================================================
Remove CancerControl-v0 from registry
============================================================================================
Device set to : NVIDIA GeForce RTX 3090
============================================================================================
training environment name : gym_cancer:CancerControl-v0--patient011
2021-12-11 19:30:18.499239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
current logging run number for gym_cancer:CancerControl-v0 :  7
Actions are logged at : PPO_logs/gym_cancer:CancerControl-v0//patient011/PPO_ActionList_gym_cancer:CancerControl-v0_patient011_log_7.csv
save checkpoint path : PPO_preTrained/gym_cancer:CancerControl-v0/patient011/
save checkpoint format : patient011_20211211-1930_PPO_gym_cancer:CancerControl-v0_490_0.pth
--------------------------------------------------------------------------------------------
num of envs : 2
max training updating times :  100000
max timesteps per episode :  120
model saving frequency : 500 episodes
log frequency : 2 episodes
printing average reward over episodes in last : 2 episodes
--------------------------------------------------------------------------------------------
state space dimension :  7
action space dimension :  10
--------------------------------------------------------------------------------------------
Initializing a discrete action space policy
--------------------------------------------------------------------------------------------
The initial explore rate : 0.8 and initial exploit rate is : 1- 0.8
PPO update frequency : 2 episodes
PPO K epochs :  4
PPO epsilon clip :  0.2
discount factor (gamma) :  0.99
--------------------------------------------------------------------------------------------
decaying optimizer with step size :  500  decay ratio :  0.5
optimizer learning rate actor :  3e-05
optimizer learning rate critic :  0.0001
--------------------------------------------------------------------------------------------
setting random seed to  490
============================================================================================
Started training at (GMT) :  2021-12-11 19:30:23
============================================================================================
Traceback (most recent call last):
  File "train.py", line 535, in <module>
    train(args)
  File "train.py", line 372, in train
    state_tensor, action, action_logprob = ppo_agent.select_action(fea) \
  File "/home/yitao/PPO-Pytorch/PPO.py", line 211, in select_action
    action, action_logprob = self.policy_old.act(state)
  File "/home/yitao/PPO-Pytorch/PPO.py", line 96, in act
    action_probs = self.actor(state)
  File "/opt/anaconda3/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/opt/anaconda3/lib/python3.8/site-packages/torch/nn/modules/container.py", line 117, in forward
    input = module(input)
  File "/opt/anaconda3/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/opt/anaconda3/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 93, in forward
    return F.linear(input, self.weight, self.bias)
  File "/opt/anaconda3/lib/python3.8/site-packages/torch/nn/functional.py", line 1692, in linear
    output = input.matmul(weight.t())
RuntimeError: CUDA error: CUBLAS_STATUS_NOT_INITIALIZED when calling `cublasCreate(handle)`
